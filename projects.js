'use strict';

const dataOfObjectsImagesProgect = {
  bathroom: {
    '07052024': {
      arrayOfImages: [
        {
          id: '1',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-3.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-3.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-3-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-3-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-3-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-3-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-3-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-3-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        },
        {
          id: '2',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-5.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-5.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-5-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-5-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-5-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-5-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-5-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-5-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        },
        {
          id: '3',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        },
        {
          id: '4',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        },
        {
          id: '5',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-1.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-1.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-1-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-1-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-1-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-1-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-1-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-1-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        },
        {
          id: '6',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-1.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-1.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-1-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-1-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-1-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-1-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-1-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-2-1-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        },
        {
          id: '7',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-4.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-4.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-4-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-4-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-4-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-4-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-4-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-4-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        },
        {
          id: '8',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-6.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-6.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-6-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-6-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-6-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-6-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-6-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-6-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        },
        {
          id: '9',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-7.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-7.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-7-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-7-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-7-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-7-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-7-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-7-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        },
        {
          id: '10',
          src: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-8.jpg',
          srcset: './images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-8.jpg 960w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-8-150x150.jpg 150w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-8-300x300.jpg 300w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-8-768x768.jpg 768w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-8-50x50.jpg 50w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-8-555x555.jpg 555w, ./images/services/bathroom/07052024/bathroom-remodeling-memphis-tn-8-600x600.jpg 600w',
          sizes: '(max-width: 960px) 100vw, 960px',
          title: '',
          alt: 'bathroom-remodeling-memphis-tn-3'
        }
      ],
      
    }
  }
}

const buttonsProjectsLink = document.querySelectorAll('.js-projects__link');
const projectsList = document.querySelector('#projects-list');
const buttonsQuickView = document.querySelectorAll('[data-id="buttonQuickView"]');
const modal = document.querySelector('#modal');
const buttonCloseModal = document.querySelector('#closeModal');
const buttonsChangePicture = document.querySelectorAll('[data-action="change-picture"]');

let filterBy = 'all';

filterProjects();
buttonCloseModal.addEventListener('click', closeModal);

forEachCustom(buttonsQuickView, openModalWindow);

forEachCustom(buttonsProjectsLink, (e) => {
  if (e.target.dataset.filter === filterBy) {
    return;
  }

  filterBy = e.target.dataset.filter;

  filterProjects();
});

forEachCustom(buttonsChangePicture, openModalWindow);


function forEachCustom(elems, foo) {
  for (let i = 0; i < elems.length; i++) {
    elems[i].addEventListener('click', foo);
  }
}

function filterProjects() {
  addActiveLinkToProject(filterBy);

  if (filterBy === 'all') {
    for (let i = 0; i < projectsList.children.length; i++) {
      projectsList.children[i].hidden = false;
    };
    return;
  }
  
  for (let i = 0; i < projectsList.children.length; i++) {

    if (projectsList.children[i].dataset.type === filterBy) {
      projectsList.children[i].hidden = false;
    } else {
      projectsList.children[i].hidden = true;
    }
  };
};

function addActiveLinkToProject(filter) {
  for (let i = 0; i < buttonsProjectsLink.length; i++) {
    if (buttonsProjectsLink[i].dataset.filter === filter) {
      buttonsProjectsLink[i].classList.add('projects__link--active');

      continue;
    }

    buttonsProjectsLink[i].classList.remove('projects__link--active');
  }
}

let typeOfElementForModalImage = '';
let idElementForModalImage = '';
let indexOfActiveElementForModalImage = 0;


function openModalWindow(e) {
  console.dir(e.target.dataset.id);
  openModal();

  const parent = e.target.closest('[data-type]')

  if (e.target.dataset.id === 'buttonQuickView') {
    idElementForModalImage = parent.dataset.id;
    typeOfElementForModalImage = parent.dataset.type;
    indexOfActiveElementForModalImage = 0;
  }

  const { arrayOfImages } = dataOfObjectsImagesProgect[typeOfElementForModalImage][idElementForModalImage];

  if (e.target.dataset.id === 'button-prev-picture') {
    indexOfActiveElementForModalImage = indexOfActiveElementForModalImage - 1 < 0 ? arrayOfImages.length - 1 : indexOfActiveElementForModalImage - 1;

  }

  if (e.target.dataset.id === 'button-next-picture') {
    indexOfActiveElementForModalImage = indexOfActiveElementForModalImage + 1 > arrayOfImages.length -1 ? 0 : indexOfActiveElementForModalImage + 1;
  }

  console.log(indexOfActiveElementForModalImage);

  const img = createImage(arrayOfImages, indexOfActiveElementForModalImage, typeOfElementForModalImage);

  const containerImg = modal.querySelector('#containerImgModal');

  img.onload = () => {
    containerImg.innerHTML = '';
    containerImg.append(img);
    
    deactivateSpinWhenLoad();
  }
};

function createImage(arr, i, type) {
  const img = document.createElement('img');
  img.src = `${arr[i].src}`;
  img.classList.add('modal__img');

  if (arr[i].srcset !== '') {
    img.srcset = `${arr[i].srcset}`;
    img.sizes = `${arr[i].sizes}`;
  }
  
  img.alt = `${arr[i].srcset}`;
  img.title = `${arr[i].srcset}`;
  img.dataset.id = `${i}`;
  img.dataset.type = `${type}`;

  return img;
}

function activateSpinWhenLoad() {
  const spinEll = modal.querySelector('#modal-spin');

  spinEll.classList.add('modal__spin--active');
}

function deactivateSpinWhenLoad() {
  const spinEll = modal.querySelector('#modal-spin');

  spinEll.classList.remove('modal__spin--active');
}

function toogleScroll(condition = true) {
  const body = document.body;
  if (condition) {
    body.style.overflow = 'hidden';
  } else {
    body.style.overflow = 'scroll';
  }
}

function openModal() {
  modal.classList.add('modal--open');
  toogleScroll();
  activateSpinWhenLoad();
}

function closeModal() {
  modal.classList.remove('modal--open');
  toogleScroll(false);
  deactivateSpinWhenLoad();
  typeOfElementForModalImage = '';
  idElementForModalImage = '';
  indexOfActiveElementForModalImage = 0;
}